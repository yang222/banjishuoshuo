<!DOCTYPE html>
<html lang="en">
<head>
    <title>Aspect Ratio with Preview Pane | Jcrop Demo</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>
    <link rel="stylesheet" type="text/css" href="/css/jquery.Jcrop.css">
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.Jcrop.js"></script>
    <script type="text/javascript" src="/js/xiaoguo.js"></script>
</head>
<style>
    #preview-pane .preview-container{
        width: 200px;
        height: 200px;
    }
    #btn{
        width: 80px;
        display: block;
        height: 30px;
        line-height: 30px;
        margin-top: 20px;
        cursor: pointer;
        margin: 0 auto;
    }
    .jcrop-holder{
        margin: 100px auto;
    }
</style>
<body>

<img src="/avatar/<%=avatar%>" id="target" alt="[Jcrop Example]"/>

<div id="preview-pane">
    <div class="preview-container">
        <img src="/avatar/<%=avatar%>" class="jcrop-preview" alt="Preview"/>
    </div>
</div>

<input type="button" value="剪裁" id="btn">


<script type="text/javascript">
    $("input").click(function () {
        var w = parseInt($(".jcrop-holder>div:first").css("width"));
        var h = parseInt($(".jcrop-holder>div:first").css("height"));
        var x = parseInt($(".jcrop-holder>div:first").css("left"));
        var y = parseInt($(".jcrop-holder>div:first").css("top"));

        $.get("/docut",{
            "w" : w,
            "h" : h,
            "x" : x,
            "y" : y
        },function(result){
            if(result.code== "1000"){
                alert("头像更改成功！！");
                window.location = "/";
            }else if(result.code == "1001"){
                alert("头像更改失败！！");
            }else if(result.code == "1002"){
                alert("服务器内部错误！");
            }
        });
    });
</script>
</body>
</html>

